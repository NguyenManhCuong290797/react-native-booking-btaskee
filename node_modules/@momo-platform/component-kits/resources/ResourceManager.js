var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _reactNative=require("react-native");var _lodash=require("lodash");var _Observer=_interopRequireDefault(require("../observer/Observer"));var _cached_images=_interopRequireDefault(require("../components/icon/cached_images.json"));var _cached_images_v=_interopRequireDefault(require("../components/icon/cached_images_v2.json"));var _ValueUtil=_interopRequireDefault(require("../utils/ValueUtil"));function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){(0,_defineProperty2.default)(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}var cached=_objectSpread(_objectSpread({},_cached_images.default),_cached_images_v.default);var RNResource=_reactNative.NativeModules.RNResource;var ResourceManager=(0,_createClass2.default)(function ResourceManager(){(0,_classCallCheck2.default)(this,ResourceManager);});exports.default=ResourceManager;ResourceManager.STICKER='sticker';ResourceManager.LOTTIE='lottie';ResourceManager.ICON='icon';ResourceManager.LANGUAGE='language';ResourceManager.NAVIGATION_BAR='navigationBar';ResourceManager.resource={};ResourceManager.isLoadResource={};ResourceManager.getCacheResource=function(){var key=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'icon';return RNResource!=null&&RNResource[key]?_ValueUtil.default.parseData(RNResource==null?void 0:RNResource[key]):'';};ResourceManager.getResource=function(){var key=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'icon';return new Promise(function(resolve,reject){return RNResource.getResource(key).then(function(resouce){return(0,_lodash.isEmpty)(resouce)?reject():resolve(_ValueUtil.default.parseData(resouce));}).catch(function(e){return reject(e);});});};ResourceManager.setResource=function(data){var key=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'icon';var resource=data;if(typeof resource!=='string')resource=JSON.stringify(resource);ResourceManager.resource[key]=_ValueUtil.default.parseData(resource);var observer=_Observer.default.getInstance(key);observer.notify();return RNResource.setResource(resource,key);};ResourceManager.removeResource=function(){var key=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'icon';return RNResource.removeResource(key);};ResourceManager.loadResource=function(key){if((0,_lodash.isEmpty)(ResourceManager.resource[key])&&!ResourceManager.isLoadResource[key]){ResourceManager.isLoadResource[key]=true;try{ResourceManager.resource[key]=(0,_lodash.isEmpty)(_ValueUtil.default.parseData(RNResource[key]))?key==='icon'?cached:'':_ValueUtil.default.parseData(RNResource[key]);var observer=_Observer.default.getInstance(key);observer.notify();ResourceManager.isLoadResource[key]=false;}catch(error){ResourceManager.isLoadResource[key]=false;console.warn("Get "+key+" resource error. Please try again",error);}}};